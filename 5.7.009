To: vim-dev@vim.org
Subject: Patch 5.7.009 (extra)
Fcc: outbox
From: Bram Moolenaar <Bram@moolenaar.net>
------------

Patch 5.7.009 (extra)
Problem:    Mac: Crash when using a long file.
Solution:   Don't redefine malloc() and free(), because it will break using
            realloc().
Files:      src/os_mac.h


*** ../vim-5.7.8/src/os_mac.h	Wed Jun  7 12:30:32 2000
--- src/os_mac.h	Sun Jul 23 12:45:19 2000
***************
*** 31,42 ****
  #include <stat.h>
  #include <unix.h>
  
  /*
   * Use Macintosh subroutine to alloc the memory.
   * (malloc generate Ptr format hard to debug with ZoneRanger)
   */
! #define malloc(x) NewPtr(x)
! #define free(x)   DisposePtr((char *) x)
  
  /* This will go away when CMD_KEY fully tested */
  #define USE_CMD_KEY
--- 31,44 ----
  #include <stat.h>
  #include <unix.h>
  
+ #if 0	    /* this doesn't work, because realloc() isn't redefined */
  /*
   * Use Macintosh subroutine to alloc the memory.
   * (malloc generate Ptr format hard to debug with ZoneRanger)
   */
! # define malloc(x) NewPtr(x)
! # define free(x)   DisposePtr((char *) x)
! #endif
  
  /* This will go away when CMD_KEY fully tested */
  #define USE_CMD_KEY
*** ../vim-5.7.8/src/version.c	Sat Aug  5 16:53:54 2000
--- src/version.c	Mon Aug  7 09:52:55 2000
***************
*** 439,440 ****
--- 439,442 ----
  {   /* Add new patch number below this line */
+ /**/
+     9,
  /**/

-- 
hundred-and-one symptoms of being an internet addict:
142. You dream about creating the world's greatest web site.

///  Bram Moolenaar     Bram@moolenaar.net     http://www.moolenaar.net  \\\
\\\  Vim: http://www.vim.org      ICCF Holland: http://iccf-holland.org  ///
